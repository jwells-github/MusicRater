@model ReleaseViewModel
@{ 
    ViewData["Title"] = Model.Title;
    int minimumRating = 1;
    int maximumRating = 10;
    int defaultSelectOption = 10;
    bool releaseRated = false;
    if(Model.UserRating != null)
    {
        if (Model.UserRating.Rating != 0)
        {
            releaseRated = true;
            defaultSelectOption = Model.UserRating.Rating;
        }
    }
}

<div>
    <h1>@Model.Artist.Name</h1>
    <h2>@Model.Title</h2>
    <p>
        Released: @(Model.ReleaseDay > 0 ? Model.ReleaseDay.ToString() : "") 
        @Model.MonthString() 
        @(Model.ReleaseYear > 0 ? Model.ReleaseYear.ToString() : "")
    </p>
    <p>Average @Model.AverageRating / 10 from @Model.NumberOfRatings Ratings</p>

    @if (User.Identity.IsAuthenticated)
    {
        <h3>@(releaseRated ? "You rated this release "+@defaultSelectOption+" / 10" : "You have not rated this release")</h3>
        <div class="form-group">
            <form method="post" action="/Release/Rate/@Model.ReleaseID">
                <select id="rating" name="rating">
                    @for (int i = maximumRating; i >= minimumRating; i--)
                    {
                        @if (releaseRated)
                        {
                            @if (i == Model.UserRating.Rating)
                            {
                                <option selected="selected">@i</option>
                                continue;
                            }
                        }
                        <option>@i</option>
                    }
                </select>
                <button class="btn btn-primary" type="submit">
                    @(releaseRated ? "Update Rating" : "Rate")
                </button>
            </form>
        </div>
    }

</div>